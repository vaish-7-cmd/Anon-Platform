<h1>Anonymous Confessions ðŸ’Œ</h1>
<a href="/confessions/confess" class="btn btn-secondary mb-3">Write a Confession</a>

<% if (confessions.length === 0) { %>
  <p>No confessions yet. Be the first!</p>
<% } else { %>
  <% confessions.forEach(confession => { %>
    <div class="card p-3 mb-3">
      <p><%= confession.story %></p>

      <% if (confession.media) { %>
        <img src="<%= confession.media %>" alt="attachment" style="max-width:200px;">
      <% } %>

      <small><%= confession.createdAt.toDateString() %></small>

      <!-- âœ… Edit input stays full width -->
      <form action="/confessions/<%= confession._id %>/edit" method="POST" class="mt-2">
        <input type="text" name="story" class="form-control mb-2" value="<%= confession.story %>" required>

        <!-- âœ… Buttons on same line -->
        <div class="d-flex">
          <button type="submit" class="btn btn-sm btn-warning me-2">Edit</button>
        </form>
        <form action="/confessions/<%= confession._id %>/delete" method="POST" 
              onsubmit="return confirm('Are you sure you want to delete this confession?');">
          <button type="submit" class="btn btn-sm btn-danger">Delete</button>
        </form>
        </div>

      <h5 class="mt-3">Replies:</h5>
      <ul>
        <% confession.replies.forEach(r => { %>
          <li><%= r.text %></li>
        <% }) %>
      </ul>

      <form action="/confessions/<%= confession._id %>/reply" method="POST" class="mt-2">
        <input type="text" name="text" placeholder="Write a reply" required class="form-control mb-2">
        <button type="submit" class="btn btn-sm btn-success">Reply</button>
      </form>
    </div>
  <% }) %>
<% } %>
